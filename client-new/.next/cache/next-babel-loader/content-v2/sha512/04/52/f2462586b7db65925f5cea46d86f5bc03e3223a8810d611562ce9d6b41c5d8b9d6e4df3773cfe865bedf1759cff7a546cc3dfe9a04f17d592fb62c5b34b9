{"ast":null,"code":"import { GLOBAL, AUTH } from \"../defines\";\nimport axios from \"axios\";\nimport setAuthToken from \"../setAuthToken\";\nimport { API_BASE_URL } from \"@/utils/config\";\nexport const setGlobalCurrency = cur => ({\n  type: GLOBAL.SET_CURRENCY,\n  cur\n});\nexport const setGlobalCategory = category => ({\n  type: GLOBAL.SET_CATEGORY,\n  category\n});\nexport const setGlobalSearch = keyword => ({\n  type: GLOBAL.SET_SEARCH,\n  keyword\n});\nexport const login = data => ({\n  type: AUTH.LOG_IN,\n  payload: data\n});\nexport const register = data => ({\n  type: AUTH.SIGN_UP,\n  payload: data\n});\nexport const logout = () => dispatch => {\n  localStorage.removeItem('userInfo');\n  localStorage.removeItem('cartItems');\n  localStorage.removeItem('persist:root');\n  localStorage.removeItem('shippingAddress');\n  localStorage.removeItem('paymentMethod');\n  localStorage.removeItem('token');\n  dispatch({\n    type: AUTH.LOG_OUT\n  });\n  document.location.href = '/';\n};\nexport const loadUser = () => async dispatch => {\n  if (localStorage.token) {\n    const token = localStorage.token.replaceAll('\"', ''); //sending token to headers\n\n    setAuthToken(token);\n  }\n\n  try {\n    const res = await axios.get(`${API_BASE_URL}/api/v1/auth/me`);\n    dispatch({\n      type: AUTH.LOAD_USER,\n      payload: res.data.data\n    });\n  } catch (err) {\n    dispatch({\n      type: AUTH.LOAD_USER_FAIL,\n      payload: err.response.data.error\n    });\n  }\n};\nexport const createOrder = order => async dispatch => {\n  try {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post(`${API_BASE_URL}/api/orders`, order, config);\n    dispatch({\n      type: AUTH.ORDER_SUCCESS,\n      payload: data\n    });\n    localStorage.removeItem('cartItems');\n    localStorage.removeItem('persist:root');\n  } catch (error) {\n    const messages = error.response && error.response.data.message ? error.response.data.message : error.message;\n\n    if (messages === 'Not authorized, token failed') {\n      dispatch(logout());\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/2012b/WebstormProjects/ecommerce-MERN/client-new/src/redux/actions/globalActions.ts"],"names":["GLOBAL","AUTH","axios","setAuthToken","API_BASE_URL","setGlobalCurrency","cur","type","SET_CURRENCY","setGlobalCategory","category","SET_CATEGORY","setGlobalSearch","keyword","SET_SEARCH","login","data","LOG_IN","payload","register","SIGN_UP","logout","dispatch","localStorage","removeItem","LOG_OUT","document","location","href","loadUser","token","replaceAll","res","get","LOAD_USER","err","LOAD_USER_FAIL","response","error","createOrder","order","config","headers","post","ORDER_SUCCESS","messages","message"],"mappings":"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","sourcesContent":["import {GLOBAL, FORM, AUTH} from \"../defines\";\r\nimport axios from \"axios\";\r\nimport setAuthToken from \"../setAuthToken\";\r\nimport {API_BASE_URL} from \"@/utils/config\";\r\nimport Toast from 'light-toast';\r\n\r\nexport const setGlobalCurrency = (cur:string) => ({\r\n    type: GLOBAL.SET_CURRENCY,\r\n    cur,\r\n});\r\n\r\nexport const setGlobalCategory = (category:string) => ({\r\n    type: GLOBAL.SET_CATEGORY,\r\n    category,\r\n});\r\n\r\nexport const setGlobalSearch = (keyword:string) => ({\r\n    type: GLOBAL.SET_SEARCH,\r\n    keyword,\r\n});\r\nexport const login = (data) => ({\r\n    type: AUTH.LOG_IN,\r\n    payload: data,\r\n});\r\nexport const register = (data) => ({\r\n    type: AUTH.SIGN_UP,\r\n    payload: data,\r\n});\r\n\r\nexport const logout = () => (dispatch:any) => {\r\n    localStorage.removeItem('userInfo')\r\n    localStorage.removeItem('cartItems')\r\n    localStorage.removeItem('persist:root')\r\n    localStorage.removeItem('shippingAddress')\r\n    localStorage.removeItem('paymentMethod')\r\n    localStorage.removeItem('token')\r\n    dispatch({type: AUTH.LOG_OUT})\r\n    document.location.href = '/'\r\n}\r\nexport const loadUser = () => async (dispatch:any) => {\r\n    if (localStorage.token) {\r\n        const token=localStorage.token.replaceAll('\"','')\r\n        //sending token to headers\r\n        setAuthToken(token)\r\n    }\r\n    try {\r\n        const res = await axios.get(`${API_BASE_URL}/api/v1/auth/me`);\r\n        dispatch({\r\n            type: AUTH.LOAD_USER,\r\n            payload: res.data.data\r\n        })\r\n\r\n    } catch (err) {\r\n        dispatch({\r\n            type: AUTH.LOAD_USER_FAIL,\r\n            payload: err.response.data.error\r\n        })\r\n    }\r\n};\r\nexport const createOrder = (order:object) => async (dispatch:any) => {\r\n    try {\r\n\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n        }\r\n\r\n        const { data } = await axios.post(`${API_BASE_URL}/api/orders`, order, config)\r\n\r\n        dispatch({\r\n            type:AUTH.ORDER_SUCCESS,\r\n            payload: data,\r\n        })\r\n\r\n        localStorage.removeItem('cartItems')\r\n        localStorage.removeItem('persist:root')\r\n    } catch (error) {\r\n        const messages =\r\n            error.response && error.response.data.message\r\n                ? error.response.data.message\r\n                : error.message\r\n        if (messages === 'Not authorized, token failed') {\r\n            dispatch(logout())\r\n        }\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}