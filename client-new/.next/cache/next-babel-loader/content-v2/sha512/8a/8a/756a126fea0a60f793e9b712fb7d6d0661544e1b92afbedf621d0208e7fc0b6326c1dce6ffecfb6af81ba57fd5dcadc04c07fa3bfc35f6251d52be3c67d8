{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\2012b\\\\WebstormProjects\\\\ecommerce-MERN\\\\client-new\\\\src\\\\features\\\\checkouts\\\\StripePaymentForm.tsx\";\nimport React from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport axios from \"axios\";\nimport { API_BASE_URL } from \"@/utils/config\";\nimport StripeFormWrapper, { Heading, FieldWrapper } from './stripe.style';\nimport { useSelector } from \"react-redux\";\nconst stripePromise = loadStripe('pk_test_51HR1HeEbiqPmtL9pHZqB2BQzFzjisQybiUnf6wzJHj1UD4stgUOuzQLLfcxowVS0c8RhEAAIRVO643Mu4QSsE3jk007D69CHI7');\n\nconst StripeForm = ({\n  buttonText,\n  getToken\n}) => {\n  // Get a reference to Stripe or Elements using hooks.\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const handleSubmit = async () => {\n    if (!stripe || !elements) {\n      // Stripe.js has not loaded yet. Make sure to disable\n      // form submission until Stripe.js has loaded.\n      return;\n    } // Use elements.getElement to get a reference to the mounted Element.\n\n\n    const cardElement = elements.getElement(CardElement); // Pass the Element directly to other Stripe.js methods:\n    // e.g. createToken - https://stripe.com/docs/js/tokens_sources/create_token?type=cardElement\n\n    const {\n      token\n    } = await stripe.createToken(cardElement);\n\n    if (token) {\n      getToken(token);\n      console.log({\n        token: token\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(StripeFormWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(Heading, {\n      children: \"Enter card info\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(FieldWrapper, {\n      children: /*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: handleSubmit,\n      children: \"Pay Now\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 9\n  }, this);\n};\n\nconst StripePaymentForm = ({\n  item: {\n    price,\n    buttonText\n  }\n}) => {\n  const billing = useSelector(state => state.shopReducer);\n  const cartState = useSelector(state => state.cartReducer);\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const sendTokenToServer = async () => {\n    const {\n      data\n    } = await axios.post(`${API_BASE_URL}/api/v1/order/`, {\n      orderItems: cartState,\n      paymentMethod: \"card\",\n      itemsPrice: 500,\n      taxPrice: 20,\n      shippingPrice: 4,\n      totalPrice: price,\n      shippingAddress: billing.address,\n      name: billing.billing.name,\n      number: billing.billing.number\n    }, config);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(StripeForm, {\n      getToken: () => sendTokenToServer(),\n      buttonText: buttonText\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n};\n\nexport default StripePaymentForm;","map":{"version":3,"sources":["C:/Users/2012b/WebstormProjects/ecommerce-MERN/client-new/src/features/checkouts/StripePaymentForm.tsx"],"names":["React","loadStripe","Elements","CardElement","useStripe","useElements","axios","API_BASE_URL","StripeFormWrapper","Heading","FieldWrapper","useSelector","stripePromise","StripeForm","buttonText","getToken","stripe","elements","handleSubmit","cardElement","getElement","token","createToken","console","log","StripePaymentForm","item","price","billing","state","shopReducer","cartState","cartReducer","config","headers","sendTokenToServer","data","post","orderItems","paymentMethod","itemsPrice","taxPrice","shippingPrice","totalPrice","shippingAddress","address","name","number"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\r\nimport {loadStripe} from '@stripe/stripe-js';\r\nimport {\r\n    Elements,\r\n    CardElement,\r\n    useStripe,\r\n    useElements,\r\n} from '@stripe/react-stripe-js';\r\nimport axios from \"axios\";\r\nimport {API_BASE_URL} from \"@/utils/config\";\r\nimport StripeFormWrapper, {Heading, FieldWrapper} from './stripe.style';\r\nimport {useSelector} from \"react-redux\";\r\n\r\nconst stripePromise = loadStripe('pk_test_51HR1HeEbiqPmtL9pHZqB2BQzFzjisQybiUnf6wzJHj1UD4stgUOuzQLLfcxowVS0c8RhEAAIRVO643Mu4QSsE3jk007D69CHI7');\r\n\r\nconst StripeForm = ({buttonText, getToken}) => {\r\n    // Get a reference to Stripe or Elements using hooks.\r\n    const stripe = useStripe();\r\n    const elements = useElements();\r\n    const handleSubmit = async () => {\r\n        if (!stripe || !elements) {\r\n            // Stripe.js has not loaded yet. Make sure to disable\r\n            // form submission until Stripe.js has loaded.\r\n            return;\r\n        }\r\n        // Use elements.getElement to get a reference to the mounted Element.\r\n        const cardElement = elements.getElement(CardElement);\r\n\r\n        // Pass the Element directly to other Stripe.js methods:\r\n        // e.g. createToken - https://stripe.com/docs/js/tokens_sources/create_token?type=cardElement\r\n        const {token} = await stripe.createToken(cardElement);\r\n        if (token) {\r\n            getToken(token);\r\n\r\n            console.log({token:token})\r\n        }\r\n    };\r\n    return (\r\n        <StripeFormWrapper>\r\n            <Heading>Enter card info</Heading>\r\n            <FieldWrapper>\r\n                <CardElement/>\r\n            </FieldWrapper>\r\n            <button type=\"button\" onClick={handleSubmit}>\r\n                Pay Now\r\n            </button>\r\n        </StripeFormWrapper>\r\n    );\r\n};\r\ntype Item = {\r\n    item: {\r\n        price: any;\r\n        buttonText: string;\r\n    };\r\n};\r\nconst StripePaymentForm = ({item: {price, buttonText}}: Item) => {\r\n    const billing = useSelector((state: any) => state.shopReducer);\r\n    const cartState = useSelector((state: any) => state.cartReducer);\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n    }\r\n    const sendTokenToServer = async () => {\r\n        const {data} = await axios.post(\r\n            `${API_BASE_URL}/api/v1/order/`,\r\n            {\r\n                orderItems: cartState, paymentMethod: \"card\",\r\n                itemsPrice: 500,\r\n                taxPrice: 20,\r\n                shippingPrice: 4,\r\n                totalPrice: price,\r\n                shippingAddress:billing.address ,\r\n                name:billing.billing.name,\r\n                number:billing.billing.number\r\n\r\n            },\r\n            config\r\n        )\r\n    };\r\n\r\n    return (\r\n        <Elements stripe={stripePromise}>\r\n            <StripeForm\r\n                getToken={() => sendTokenToServer()}\r\n                buttonText={buttonText}\r\n            />\r\n        </Elements>\r\n    );\r\n};\r\n\r\nexport default StripePaymentForm;\r\n"]},"metadata":{},"sourceType":"module"}