{"ast":null,"code":"import { GLOBAL, FORM, AUTH } from \"../defines\";\nimport axios from \"axios\";\nimport setAuthToken from \"../setAuthToken\";\nimport { message } from \"antd\";\nexport const setGlobalCurrency = cur => ({\n  type: GLOBAL.SET_CURRENCY,\n  cur\n});\nexport const setGlobalCategory = category => ({\n  type: GLOBAL.SET_CATEGORY,\n  category\n});\nexport const setCurrentForm = form => ({\n  type: FORM.SET_CURRENT_FORM,\n  form\n});\nexport const setGlobalSearch = keyword => ({\n  type: GLOBAL.SET_SEARCH,\n  keyword\n});\nexport const login = (email, password) => async dispatch => {\n  try {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post('http://localhost:5000/api/v1/auth/login', {\n      email,\n      password\n    }, config);\n    dispatch({\n      type: AUTH.LOG_IN,\n      payload: data\n    });\n    localStorage.setItem('userInfo', JSON.stringify(data));\n    localStorage.setItem('token', JSON.stringify(data.token));\n    await loadUser();\n  } catch (error) {\n    dispatch({\n      type: AUTH.LOG_IN_ERROR,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n};\nexport const logout = () => dispatch => {\n  localStorage.removeItem('userInfo');\n  localStorage.removeItem('cartItems');\n  localStorage.removeItem('persist:root');\n  localStorage.removeItem('shippingAddress');\n  localStorage.removeItem('paymentMethod');\n  localStorage.removeItem('token');\n  dispatch({\n    type: AUTH.LOG_OUT\n  });\n  document.location.href = '/';\n};\nexport const loadUser = () => async dispatch => {\n  if (localStorage.token) {\n    const token = localStorage.token.replaceAll('\"', ''); //sending token to headers\n\n    setAuthToken(token);\n  }\n\n  try {\n    const res = await axios.get('http://localhost:5000/api/v1/auth/me');\n    dispatch({\n      type: AUTH.LOAD_USER,\n      payload: res.data\n    });\n  } catch (err) {\n    message.error(err.response.data.error);\n    dispatch({\n      type: AUTH.LOAD_USER_FAIL,\n      payload: err.response.data.error\n    });\n  }\n};\nexport const createOrder = order => async dispatch => {\n  try {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post(`http://localhost:5000/api/orders`, order, config);\n    dispatch({\n      type: AUTH.ORDER_SUCCESS,\n      payload: data\n    });\n    localStorage.removeItem('cartItems');\n    localStorage.removeItem('persist:root');\n  } catch (error) {\n    const messages = error.response && error.response.data.message ? error.response.data.message : error.message;\n\n    if (messages === 'Not authorized, token failed') {\n      dispatch(logout());\n    }\n\n    message.warn('Something went wrong. Try again later');\n  }\n};\nexport const register = (name, email, password) => async dispatch => {\n  try {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post('http://localhost:5000/api/users', {\n      name,\n      email,\n      password\n    }, config);\n    dispatch({\n      type: AUTH.SIGN_UP,\n      payload: data\n    });\n    await loadUser();\n    localStorage.setItem('userInfo', JSON.stringify(data));\n    localStorage.setItem('token', JSON.stringify(data.token));\n  } catch (error) {\n    message.error(error.response && error.response.data.message ? error.response.data.message : error.message);\n    dispatch({\n      type: AUTH.SIGN_UP_ERROR,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n};","map":{"version":3,"sources":["/home/hari/WebstormProjects/ecommerce-MERN/client-new/src/redux/actions/globalActions.ts"],"names":["GLOBAL","FORM","AUTH","axios","setAuthToken","message","setGlobalCurrency","cur","type","SET_CURRENCY","setGlobalCategory","category","SET_CATEGORY","setCurrentForm","form","SET_CURRENT_FORM","setGlobalSearch","keyword","SET_SEARCH","login","email","password","dispatch","config","headers","data","post","LOG_IN","payload","localStorage","setItem","JSON","stringify","token","loadUser","error","LOG_IN_ERROR","response","logout","removeItem","LOG_OUT","document","location","href","replaceAll","res","get","LOAD_USER","err","LOAD_USER_FAIL","createOrder","order","ORDER_SUCCESS","messages","warn","register","name","SIGN_UP","SIGN_UP_ERROR"],"mappings":"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","sourcesContent":["import {GLOBAL, FORM, AUTH} from \"../defines\";\nimport axios from \"axios\";\nimport setAuthToken from \"../setAuthToken\";\nimport {message} from \"antd\";\n\nexport const setGlobalCurrency = (cur:string) => ({\n    type: GLOBAL.SET_CURRENCY,\n    cur,\n});\n\nexport const setGlobalCategory = (category:string) => ({\n    type: GLOBAL.SET_CATEGORY,\n    category,\n});\nexport const setCurrentForm = (form:string) => ({\n    type: FORM.SET_CURRENT_FORM,\n    form,\n});\n\nexport const setGlobalSearch = (keyword:string) => ({\n    type: GLOBAL.SET_SEARCH,\n    keyword,\n});\n\n\nexport const login = (email:string, password:string) => async (dispatch:any) => {\n    try {\n        const config = {\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        }\n\n        const {data} = await axios.post(\n            'http://localhost:5000/api/v1/auth/login',\n            {email, password},\n            config\n        )\n\n        dispatch({\n            type: AUTH.LOG_IN,\n            payload: data,\n        })\n        localStorage.setItem('userInfo', JSON.stringify(data))\n        localStorage.setItem('token', JSON.stringify(data.token))\n        await loadUser()\n\n    } catch (error) {\n        dispatch({\n            type: AUTH.LOG_IN_ERROR,\n            payload:\n                error.response && error.response.data.message\n                    ? error.response.data.message\n                    : error.message,\n        })\n    }\n}\nexport const logout = () => (dispatch:any) => {\n    localStorage.removeItem('userInfo')\n    localStorage.removeItem('cartItems')\n    localStorage.removeItem('persist:root')\n    localStorage.removeItem('shippingAddress')\n    localStorage.removeItem('paymentMethod')\n    localStorage.removeItem('token')\n    dispatch({type: AUTH.LOG_OUT})\n    document.location.href = '/'\n}\nexport const loadUser = () => async (dispatch:any) => {\n    if (localStorage.token) {\n        const token=localStorage.token.replaceAll('\"','')\n        //sending token to headers\n        setAuthToken(token)\n    }\n    try {\n        const res = await axios.get('http://localhost:5000/api/v1/auth/me');\n        dispatch({\n            type: AUTH.LOAD_USER,\n            payload: res.data\n        })\n\n    } catch (err) {\n        message.error(err.response.data.error)\n        dispatch({\n            type: AUTH.LOAD_USER_FAIL,\n            payload: err.response.data.error\n        })\n    }\n};\nexport const createOrder = (order:object) => async (dispatch:any) => {\n    try {\n\n        const config = {\n            headers: {\n                'Content-Type': 'application/json'\n            },\n        }\n\n        const { data } = await axios.post(`http://localhost:5000/api/orders`, order, config)\n\n        dispatch({\n            type:AUTH.ORDER_SUCCESS,\n            payload: data,\n        })\n\n        localStorage.removeItem('cartItems')\n        localStorage.removeItem('persist:root')\n    } catch (error) {\n        const messages =\n            error.response && error.response.data.message\n                ? error.response.data.message\n                : error.message\n        if (messages === 'Not authorized, token failed') {\n            dispatch(logout())\n        }\n        message.warn('Something went wrong. Try again later')\n    }\n}\n\nexport const register = (name:string, email:string, password:string) => async (dispatch:any) => {\n    try {\n        const config = {\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        }\n\n        const {data} = await axios.post(\n            'http://localhost:5000/api/users',\n            {name, email, password},\n            config\n        )\n\n        dispatch({\n            type: AUTH.SIGN_UP,\n            payload: data,\n        })\n        await loadUser()\n\n        localStorage.setItem('userInfo', JSON.stringify(data))\n        localStorage.setItem('token', JSON.stringify(data.token))\n    } catch (error) {\n        message.error(error.response && error.response.data.message\n            ? error.response.data.message\n            : error.message)\n\n        dispatch({\n            type: AUTH.SIGN_UP_ERROR,\n\n            payload:\n                error.response && error.response.data.message\n                    ? error.response.data.message\n                    : error.message,\n        })\n    }\n}\n"]},"metadata":{},"sourceType":"module"}